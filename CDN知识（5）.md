- ##                                                           智能DNS解析基本过程


#### ----------------------------------------------------------------------------------------------------------域名服务器

### DNS根服务器                                                                                       																                             	com域名服务器

#### ----------------------------------------------------------------------------------------------------------域名服务器

###                                                                                                                                                                                                          ----------------------------------------------本地DNS服务器

###                                                                                                                                                                                                                     -------------------------------------------------网络客户端

- ##  CDN加速全过程

### 网站授权  ----------------------->

###                                                                      >------Local   DNS---------------->用户访问

### 智能DNS调度----------------->

###                                                                    >--CDN服务网络

### 过程

1. 浏览器向LDNS请求对www.a.com的解析。
2. LDNS将请求发到网站授权DNS服务器。
3. 授权DNS返回一个CNAME（www.a.alikunlun.com）给LDNS。
4. LDNS重新去CDN智能调度系统请求www.a.alikunlun.com的解析。
5. CDN智能调度系统，根据用户ldns所在区域返回给LDNS离用户最近的CDN节点ip地址。
6. LDNS系统将最终解析到的IP地址告诉用户，同时将该解析结果保存在自己的缓存中，直到相应的TTL（生存周期）过期，继续完成新的动作。
7. 用户在拿到CDN节点ip地址后，向该地址所指向节点服务器访问。

## CDN多层级缓存原理

1. 阿里云CDN主要由智能调度系统和Cache软件两个重要的环节构成。
2. Cache系统结构可由一级和二级cache节点构成。
3. L1：每个CDN节点**24**台机器，支持40GB流量，部署在各个运营商，命中90%以上。
4. L2：每个CDN节点**80**台。目前有十几个L2节点。
5. L1和L2之间是ABTN（阿里巴巴骨干网络）的BGP网络连接。

## 阿里云CDN组件分层

- ### 服务器

  ​           基础服务：静态文件分发，大文件分发，流媒体分发，应用加速

  ​           辅助服务：文件上传，内容剖析，日志分析

- ### 应用层

  全局负载：        Pharos，CMOS

  本地负载均衡：LVS，Tengine

  缓存：               Swift

  监控：               Alimonitor，Tsar，Alibench，Kunlunjing

  配置管理：        Sait，Puppet

- ### 系统层

  ​           RHEL，CentOS

- ### 设备层

  服务器，路由器，交换器，防火墙，其它专用设备





